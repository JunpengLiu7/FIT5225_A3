FROM amazonlinux:1

# workdir
WORKDIR /

# update 
RUN yum update -y
# Install libraries
RUN yum install gcc openssl-devel libssl-dev openssl11 openssl11-devel mesa-libGL wget tar -y

# download python
RUN wget https://www.python.org/ftp/python/3.9.19/Python-3.9.19.tgz
RUN tar -xzvf Python-3.9.19.tgz

# change workdir
WORKDIR /Python-3.9.19

# install python
RUN ./configure --enable-optimizations
RUN make altinstall

# install python packages
RUN mkdir /packages
# wirte cv2 to reuqirements.txt
RUN echo "opencv-python" >> /packages/requirements.txt
RUN mkdir -p /packages/opencv-python-3.9/python/lib/python3.9/site-packages
RUN pip3.9 install -r /packages/requirements.txt -t /packages/opencv-python-3.9/python/lib/python3.9/site-packages
