<!DOCTYPE html>
<html>
<head>
    <title>Upload Image</title>
</head>
<body>
    <h1>Upload Image</h1>
    <div id="feedback-container"></div>
    <form id="upload-form">
        <label for="image-file">Image File:</label>
        <input type="file" id="image-file" name="image-file" required>
        <br>
        <button type="submit">Upload</button>
    </form>

    <script>
        document.getElementById('upload-form').addEventListener('submit', function(event) {
            event.preventDefault();

            var imageFile = document.getElementById('image-file').files[0];

            var formData = new FormData();
            formData.append('image_file', imageFile);

            fetch('/upload_image/', {
                method: 'POST',
                body: formData,
                headers: {
                    'X-CSRFToken': '{{ csrf_token }}'
                }
            })
            .then(function(response) {
                // Check if the response is successful
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
        return response.json();
            })
            .then(function(data) {
                var feedbackContainer = document.getElementById('feedback-container');
                feedbackContainer.innerHTML = '';

                var feedbackElement = document.createElement('div');
                feedbackElement.classList.add('alert');
                feedbackElement.classList.add(data.success ? 'alert-success' : 'alert-danger');
                feedbackElement.textContent = data.message;
                feedbackContainer.appendChild(feedbackElement);
            })
            .catch(function(error) {
                console.error('Error:', error);

                var feedbackContainer = document.getElementById('feedback-container');
                feedbackContainer.innerHTML = '';

                var feedbackElement = document.createElement('div');
                feedbackElement.classList.add('alert');
                feedbackElement.classList.add('alert-danger');
                feedbackElement.textContent = 'Error uploading the image. Please try again.';
                feedbackContainer.appendChild(feedbackElement);
            });
        });
    </script>
</body>
</html>